{"issue":{"title":"[CF 1407] Unstable Affliction Stack Number overlay ","body":" <p>I am trying to put the&nbsp;number of UA's that only I have on a target over an icon. &nbsp;I tried to use&nbsp;[NumAura(\"Unstable Affliction\", source=\"player\", unit=\"target\")] but noticed that there doesn't seem to be a 'source' condition for NumAura. &nbsp;I know about making UA a group controller, but have no desire to show up to 5 buttons. &nbsp;I simply want a Number of UA's I have on the target. &nbsp;The aforementioned NumAura line works but it will show stacks from other warlocks as well, granted that i have at least one applied. &nbsp;How can I accomplish this task? &nbsp;I love TMW btw and refuse to use weak auras. haha</p>\r\n<p>&nbsp;</p>\r\n<p>Regards, Corrath</p> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ConnerP\">ConnerP</a> | Imported from CurseForge issue <a href=\"https://wow.curseforge.com/projects/tellmewhen/issues/1407\">#1407</a> | <a href=\"https://github.com/tmw-issue-import/dump/blob/master/html/1407.html\">Raw</a>","closed":true,"closed_at":"2017-08-06T05:31:21Z","created_at":"2017-05-13T20:04:09Z","updated_at":"2017-08-06T05:31:21Z","labels":[]},"comments":[{"body":" <p>bump</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"05 18 2017 09:30:19 (CST) (UTC-5:00)\" data-epoch=\"1495117819\">May 18, 2017</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ConnerP\">ConnerP</a>","created_at":"2017-05-18T14:30:17Z"},{"body":" <p>can i get some sort of response here?</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"05 31 2017 10:52:19 (CST) (UTC-5:00)\" data-epoch=\"1496245939\">May 31, 2017</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ConnerP\">ConnerP</a>","created_at":"2017-05-31T15:51:58Z"},{"body":" <p>I have tried to make something like this myself before, with not a lot of success. The main reason the code above is not working properly, is because the function \"NumAura\" that counts the number of auras on a target, has no \"Source\" parameter buildt into it. This means that the function accepts the name of a spell, but not from who.</p>\r\n<p>&nbsp;</p>\r\n<p>If this is the case, it should be possible to add a \"Source\" tag before the counter, in the following manner:</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>[Source:Name NumAura(\"Unstable Affliction\", target=\"target\")]&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>I have not tried this code snippet, but I think this should identify you as a player, and then count the number of unstable affliction instances on the target. Let me know how it turns out, or if you find some other way to sort it :)</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cidolfas86\">Cidolfas86</a>","created_at":"2017-06-08T14:41:59Z"},{"body":" <p>I had no luck with that. &nbsp;I even tried modifying the Source:Name to&nbsp;[Source:Name(\"Corrath\")...],&nbsp;[Source:Name(unit=\"Corrath\")...],&nbsp;[Source:Name(unit=\"player\")...]. &nbsp;Nothing seems to filter out the other player's UA applications.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ConnerP\">ConnerP</a>","created_at":"2017-06-24T18:07:32Z"},{"body":" <p>&nbsp;I've also tried making a group controller to display the UA's that is hidden, then tried to count the number of icons passing show in that group. &nbsp;Idk how to do the syntax for that last part though.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ConnerP\">ConnerP</a>","created_at":"2017-06-24T18:37:20Z"},{"body":" <p>The last option would be to execute some kind of custom snippet, or make your own tag for it.</p>\r\n<p>You could try and make a custom function, that runs a counter on the number of instances of unstable affliction.</p>\r\n<p>&nbsp;</p>\r\n<p>It would probably look something like this:</p>\r\n<p>&nbsp;</p>\r\n<p>function() &nbsp;<em>(Just the name of the function, and it does not need any extra input)</em><br> local count = 0<br> for i = 1, 30, 1 do<br> if (UnitAura(\"target\", i, \"PLAYER|HARMFUL\") == \"Unstable Affliction\") then <em>(checks the target if it's hostile and aura is UA)</em><br> count = count + 1 <em>(increases counter based on the UA counter)</em><br> end</p>\r\n<p><br> <br> end<br> return count <em>(we constantly return the integer number value of the number of instances)</em><br>end</p>\r\n<p>&nbsp;</p>\r\n<p>EDIT!: Oh, you will need to make sure that the icon is only tracking you (I assume Tellmewhen has some checkbox for this), to filter out external warlocks that way.</p>\r\n<p>&nbsp;</p>\r\n<p>Again, not a code I have tried myself in-game, but something like this should be what you are looking for.</p>\r\n<p>&nbsp;</p>\r\n<p>Also I am not that familiar with implementing lua snippets into tellmewhen, but I guess it comes with instructions :)</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"07 3 2017 04:59:46 (CST) (UTC-5:00)\" data-epoch=\"1499075986\">Jul 3, 2017</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cidolfas86\">Cidolfas86</a>","created_at":"2017-07-03T09:54:08Z"},{"body":" <div>\n\n```\n^1^T^SBuffOrDebuff^SHARMFUL ^SUnit^Starget ^SOnlyMine^B ^SType^Sbuff ^SName^SUnstable~`Affliction ^SEvents^T ^N1^T ^SType^SCounter ^SCounter^Suacnt ^SCounterAmt^N0 ^SCounterOperation^S= ^SEvent^SWCSP ^SOnConditionConditions^T ^N1^T ^SType^SCOUNTER ^SOperator^S&lt; ^SName^Suacnt ^t^Sn^N1 ^t^SFrequency^N0.1 ^t^N2^T ^SType^SCounter ^SCounter^Suacnt ^SCounterAmt^N0 ^SCounterOperation^S= ^SEvent^SOnEventsRestored ^SOnConditionConditions^T ^N1^T ^SType^SCOUNTER ^SOperator^S&lt; ^SName^Sagonycnt ^t^Sn^N1 ^t^SFrequency^N0.1 ^t^N3^T ^SType^SLua ^SLua^S--~`Unstable~`Affliction~`Counter~J ~J ~J local~`numuas,uamintime,uamaxtime~`=~`UAInfo(\"target\")~J ~J TMW.COUNTERS[\"uacnt\"]~`=~`numuas~J ~J TMW.UAMIN~`=~`uamintime~J TMW.UAMAX~`=~`uamaxtime~J ~J TMW:Fire(\"TMW_COUNTER_MODIFIED\",\"uacnt\") ^SEvent^SWCSP ^SOnConditionConditions^T ^N1^T ^SType^SEXISTS ^SUnit^Starget ^t^Sn^N1 ^t^SFrequency^N0.1 ^t^N4^T ^SType^SLua ^SLua^S--~`Unstable~`Affliction~`Counter~J ~J ~J TMW.COUNTERS[\"uacnt\"]~`=~`0~J ~J TMW.UAMIN~`=~`0~J TMW.UAMAX~`=~`0~J ~J TMW:Fire(\"TMW_COUNTER_MODIFIED\",\"uacnt\") ^SEvent^SOnEventsRestored ^SOnConditionConditions^T ^N1^T ^SType^SEXISTS ^SUnit^Starget ^t^Sn^N1 ^t^SFrequency^N0.1 ^t^Sn^N4 ^t^SEnabled^B ^SSettingsPerView^T ^Sicon^T ^STexts^T ^N1^S[Counter(\"uacnt\")] ^N2^S[Duration:Round]s ^t^t^t^SStates^T ^N1^T ^t^N3^T ^t^N4^T ^t^t^t^N84002^S~`~| ^Sicon^^\r\n\r\n^1^T^SName^SUAInfo ^SCode^Sfunction~`UAInfo(UnitDesc)~J ~`~`~`~`local~`filter~`=~`\"\"~J ~`~`~`~`local~`AuraName~`=~`\"Unstable~`Affliction\"~J ~`~`~`~`local~`n~`=~`0~J ~`~`~`~`local~`mintime~`=~`nil~J ~`~`~`~`local~`maxtime~`=~`0~J ~`~`~`~`~J ~`~`~`~`filter~`=~`\"PLAYER\"~J ~`~`~`~`~J ~`~`~`~`~J ~`~`~`~`if~`not~`UnitExists(UnitDesc)~`then~J ~`~`~`~`~`~`~`~`return~`0,0,0~J ~`~`~`~`end~J ~`~`~`~`--~`scan~`all~`debuffs~`on~`the~`unit~`looking~`for~`UAs~`we've~`cast~J ~`~`~`~`for~`z~`=~`1,~`256~`do~`~J ~`~`~`~`~`~`~`~`local~`debuffname,~`_,~`_,~`_,~`_,~`_,~`expiration,~`_,~`_,~`_,~`id~`=~`UnitDebuff(UnitDesc,z,filter)~J ~`~`~`~`~`~`~`~`if~`not~`debuffname~`then~J ~`~`~`~`~`~`~`~`~`~`~`~`return~`n,~`(mintime~|=nil~`and~`mintime~`or~`0),~`maxtime~J ~`~`~`~`~`~`~`~`end~J ~`~`~`~`~`~`~`~`~J ~`~`~`~`~`~`~`~`if~`debuffname~`==~`AuraName~`then~J ~`~`~`~`~`~`~`~`~`~`~`~`n~`=~`n+1~J ~`~`~`~`~`~`~`~`end~J ~`~`~`~`~`~`~`~`~J ~`~`~`~`~`~`~`~`--~`find~`least~`time~`remaining~J ~`~`~`~`~`~`~`~`if~`mintime~`==~`nil~`or~`mintime~`&gt;~`(expiration-GetTime())~`then~J ~`~`~`~`~`~`~`~`~`~`~`~`mintime~`=~`(expiration-GetTime())~J ~`~`~`~`~`~`~`~`end~J ~`~`~`~`~`~`~`~`~J ~`~`~`~`~`~`~`~`--~`find~`max~`time~`remaining~J ~`~`~`~`~`~`~`~`if~`maxtime~`&lt;~`(expiration-GetTime())~`then~J ~`~`~`~`~`~`~`~`~`~`~`~`maxtime~`=~`(expiration-GetTime())~J ~`~`~`~`~`~`~`~`end~J ~`~`~`~`~`~`~`~`~J ~`~`~`~`end~J ~`~`~`~`~J ~`~`~`~`return~`n,~`(mintime~|=nil~`and~`mintime~`or~`0),~`maxtime~J end~J ~J ~J  ^t^N84002^S~`~| ^Scodesnippet^^\r\n\n```\n</div>\r\n<p>Above are two import strings:&nbsp; the first is an icon for displaying the count of Unstable Affliction on a target (with remaining duration by however TMW decides which duration to use, experimentally seems the minimum one).&nbsp; The second is a code snippet that is needed for the icon to work.&nbsp; You will need to import them both.&nbsp; In addition to the icon itself, I have it maintain a TMW counter \"uacnt\" that can be used in counter conditions in other icons. </p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/canofbutter\">canofbutter</a>","created_at":"2017-07-08T10:21:22Z"}]}