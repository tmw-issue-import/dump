{"issue":{"title":"[CF 1469] Tracking damage taken during window ","body":" <p>Hi, I'm not sure if is the best place to ask for support, but found a similar post&nbsp;<a href=\"https://github.com/tmw-issue-import/TellMeWhen/issues?q=%5BCF%201280%5D+in%3Atitle\" rel=\"nofollow\">here</a>, which was close but not what I needed.</p>\r\n<p>I'm trying to make a TMW to track how much damage I take during Temporal Shield. At a high level, I'd like it to do this:</p>\r\n<div>\n\n```\nwhile Temporal Shield activated\r\n    highHP = whatever player's HP% is at the time TS is applied\r\n    currentHP = player's current HP%\r\n    time = 0\r\n    while time &lt; 6\r\n        currentHP = update again to player's current HP%\r\n        differenceHP = highHP - currentHP\r\n        return differenceHP            \r\n        time++\r\nreturn differenceHP\r\n\n```\n</div>\r\n<p>I don't know Lua, but I sometimes have success editing more basic Lua TMW/WA's. In the past I've been able to piece together what I want using the documentation and an existing TMW/WA. The closest I came to what I want is finding this Frenzied Regen aura that I linked above. I can see the logic, but FR acts differently to TS and don't understand all the different built in functions it's using.</p>\r\n<p>I hope this makes sense, as I said I'm a total novice so I hope my thinking is on the right path. I'm thinking I would return the differenceHP into a counter, then have Dog Tags display the counter as a %?</p>\r\n<p>Huge fan of the addon, been using it for years and now I'm trying to push it (and myself) further by getting a better understanding of Lua</p>\r\n<p>Thanks</p> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Rukk\">Rukk</a> | Imported from CurseForge issue <a href=\"https://wow.curseforge.com/projects/tellmewhen/issues/1469\">#1469</a> | <a href=\"https://github.com/tmw-issue-import/dump/blob/master/html/1469.html\">Raw</a>","closed":true,"closed_at":"2018-11-19T00:35:29Z","created_at":"2018-02-12T23:16:36Z","updated_at":"2018-11-19T00:35:29Z","labels":["question"]},"comments":[{"body":" <p>A good way to track this is by parsing COMBAT_LOG_UNFILTERED and tracking _DAMAGE events. By doing some basic filtering you can track all the damage your character has taken. You can make the function register onShow and deregister onHide.&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>In terms of what to do with the data - you can update TMW counters like this:</p>\r\n<p>&nbsp;</p>\r\n<div>\n\n```\nTMW.COUNTERS[name] = valueTMW:Fire(\"TMW_COUNTER_MODIFIED\", name)\n```\n</div>\r\n<p>I have a <a href=\"https://github.com/arieh/TellMeWhen_Script_Tools/blob/master/Examples/dave_tracker.txt\" rel=\"nofollow\">BrM Black Ox Statue tracker</a> that works based on damage parsing so you can try and reverse engineer it to your needs (it uses T<a href=\"https://wow.curseforge.com/projects/tellmewhen_script_tools\" rel=\"nofollow\">MW Script Tools</a> for counter management but you can just use the method I listed above if you don't want another addon).&nbsp;</p>\r\n<p>&nbsp;</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ariehg\">ariehg</a>","created_at":"2018-08-03T17:53:55Z"}]}