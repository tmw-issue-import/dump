{"issue":{"title":"[CF 1489] TMW Public API to set a counter value? ","body":" <p>I am using a WA script to track the number of available soul fragments for VDH since the game info has a built in delay. Currently I am thinking of writing a simple addon that will add a public SetSoulFragments and GetSoulFragments functions so that I could use that data on a TMW LUA condition, but I would have loved to just be able to set a TMW counter from WA so that I could use it for both conditions and display.</p>\r\n<p>&nbsp;</p>\r\n<p>Is such a thing possible? Would you consider adding such an API to allow external sources to provide info for TMW?</p>\r\n<p>&nbsp;</p> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ariehg\">ariehg</a> | Imported from CurseForge issue <a href=\"https://wow.curseforge.com/projects/tellmewhen/issues/1489\">#1489</a> | <a href=\"https://github.com/tmw-issue-import/dump/blob/master/html/1489.html\">Raw</a>","closed":true,"closed_at":"2018-05-07T06:34:19Z","created_at":"2018-05-03T04:49:48Z","updated_at":"2018-05-07T06:34:19Z","labels":[]},"comments":[{"body":" <p>Alternatively, is there a way to set variables writing a LUA snippet that can be accessible to TMW (since all this script does is listen to a WoW event)</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ariehg\">ariehg</a>","created_at":"2018-05-03T04:52:48Z"},{"body":" <p>In my spammy nature - to update what I've currently done - I've ported the WA script to a LUA snippet that exposes a function, then created a set of notifications that set the value of a counter.</p>\r\n<p>&nbsp;</p>\r\n<p>However, this is very awkward, since it requires a notification per value (6 in my case since I have values from 0 to 5). Maybe what I'm missing is a way to set a tag?</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ariehg\">ariehg</a>","created_at":"2018-05-03T05:44:46Z"},{"body":" <p>this is the final result btw -&nbsp;<a href=\"https://pastebin.com/Ry7P70qS\" rel=\"nofollow\">https://pastebin.com/Ry7P70qS</a> - #1 and #2 are the LUA snippet and the icon that sets the counters</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ariehg\">ariehg</a>","created_at":"2018-05-03T07:41:53Z"},{"body":" <p>Not a simple, single API call, but you can do it like this:</p>\r\n<p>&nbsp;</p>\r\n<p>local name = \"CounterName\"</p>\r\n<p>TMW.COUNTERS[name] = someValue</p>\r\n<p>TMW:Fire(\"TMW_COUNTER_MODIFIED\", name)</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2018-05-05T18:03:09Z"},{"body":" <p>ah. Sounds reasonable enough. Will just make a function that can be reused and copy-paste it :) Any chance of adding a updateCounter method in the future that does this (just to make things DRY)?</p>\r\n<p>&nbsp;</p>\r\n<p>What about the ability to set tags inside snippets? I mean - above method would probably work just as well as adding tags, but might be interesting</p>\r\n<p>&nbsp;</p>\r\n<p>Update - I have tried that - the variable is updating properly (I used LUA console to check TMW.COUNTERS[counter_name]) but the counter does work on my icons (I've obviously tried reloading etc).&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>Update 2 - got it working. One issue was that I needed to set the counter on initialization. The other (I think) was that the name I chose was too long? Can this be an issue (\"SoulFragmentsCounter\")?</p>\r\n<p>&nbsp;</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"05 6 2018 09:49:09 (CST) (UTC-5:00)\" data-epoch=\"1525618149\">May 6, 2018</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ariehg\">ariehg</a>","created_at":"2018-05-06T09:14:16Z"},{"body":" <p>Name length doesn't matter. Not likely that I'll add some other function that both sets the counter and then fires the event, since there'd be no use of it in out-of-the-box TMW.</p>\r\n<p>&nbsp;</p>\r\n<p>I don't know what you mean by \"set tags\". Do you mean creating a DogTag? You're free to use the DogTag API for that. <a href=\"https://www.wowace.com/projects/libdogtag-3-0/pages/api/lib-dog-tag-3-0-lua#title-3\" rel=\"nofollow\">https://www.wowace.com/projects/libdogtag-3-0/pages/api/lib-dog-tag-3-0-lua#title-3</a></p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2018-05-06T22:32:22Z"},{"body":" <p>Cool! Yeah I just meant the various values I can access in the text fields of the icons. Will play around with it.&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>I'm mostly interested in expanding the use case for LUA snippets. Right now it's quite difficult to get the values generated by them to the icons and groups, so their functionality is a bit limited out of the box, although the power potential for them is quite high.&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>I'll see if I can come up with some other use cases but will probably come to a different issue since this has already went out of scope :)&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>Have also started learning the codebase a bit so maybe I'll start working with PRs instead if that's something you're ok with.</p>\r\n<p>&nbsp;</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/ariehg\">ariehg</a>","created_at":"2018-05-07T06:34:12Z"}]}