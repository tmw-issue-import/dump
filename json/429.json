{"issue":{"title":"[CF 429] Text Display Class Coloring ","body":" <p>I'd suggest the possibility to make combat log event driven events (like defensive buffs gained, with no units specified but exclusions on all friendly units) able to use the class color of the unit affected by the spell in its text output.</p><p>this would perfectly imitate the behaviour of spell alerter and thus make running it additionally to tmw, obsolete.</p> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/yeahno\">yeahno</a> | Imported from CurseForge issue <a href=\"https://wow.curseforge.com/projects/tellmewhen/issues/429\">#429</a> | <a href=\"https://github.com/tmw-issue-import/dump/blob/master/html/429.html\">Raw</a>","closed":true,"closed_at":"2012-02-01T23:42:18Z","created_at":"2012-01-28T13:54:48Z","updated_at":"2012-02-03T23:11:19Z","labels":["enhancement","resolved"]},"comments":[{"body":" <p>playing around some more with text output i came across a problem with coloring while more than one text elements are showing. it seems to always color the whole raid warning frame in the color that was used for the last event to display</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/yeahno\">yeahno</a>","created_at":"2012-01-28T14:38:39Z"},{"body":" <p>Unable to reproduce the issue with the raid warning frame. Could you post the export strings of some icons that, when their events occur, this bug can be observed?</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-28T19:53:06Z"},{"body":" <p>sorry, i don't know how to correctly flag it as code in this forum:</p>\r\n<p>^1^T^SPoint^T ^Sy^F-5134329198593323 ^f-45^Sx ^F7675418365828396^f-47 ^Spoint^STOPLEFT ^SrelativePoint^STOPLEFT ^t^SScale^N1 ^SEnabled^B ^SColumns^N5 ^SIcons^T ^N1^T ^SSourceFlags^N4294770671 ^SEvents^T ^SOnShow^T ^Sb^F7735594654071675 ^f-53^Sg ^N0^SLocation ^SRaidWarningFrame^t ^SOnStart^T ^Sg^N0 ^SLocation^SRaidWarningFrame ^Sr^F8689298104573663 ^f-54^SText ^S%u^SChannel ^SFRAME^t ^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SName^SDefensiveBuffs ^SEnabled^B ^SCLEUDur^N2 ^t^N2^T ^SSourceFlags^N4294770671 ^SEvents^T ^SOnShow^T ^Sb^N0 ^Sg^F8971876904722400 ^f-54^SLocation ^SRaidWarningFrame^t ^SOnStart^T ^Sb^F5651576002974740 ^f-58^Sg ^N0^SLocation ^SRaidWarningFrame^SText ^S%u^SChannel ^SFRAME^t ^t^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SType^Scleu ^SName^SDamageBuffs ^SFakeHidden^B ^SEnabled^B ^SCLEUDur^N2 ^t^N3^T ^SSourceFlags^N4294967279 ^SEvents^T ^SOnShow^T ^Sb^N0 ^SLocation^SRaidWarningFrame ^Sr^F8053495804239005 ^f-55^t ^SOnStart^T ^Sb^F8618653404536478 ^f-55^SLocation ^SRaidWarningFrame^Sr ^N0^SChannel ^SFRAME^t ^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_START^B ^t^SName^SHeals;`PvPSpells ^SEnabled^B ^SCLEUDur^N2 ^t^N4^T ^SSourceFlags^N4294967279 ^SEvents^T ^SOnShow^T ^Sb^F7947528754183228 ^f-53^SLocation ^SRaidWarningFrame^Sr ^N0^SText ^S%u^SChannel ^SFRAME^SSound ^STMW`-`Ding`5^SSoundData ^SInterface\\Addons\\TellMeWhen\\Sounds\\Ding5.ogg^t ^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SName^SSmoke`Bomb;`Psychic`Scream;`Death`Coil;`Scatter`Shot;`Vanish;`Sap;`Freezing`Trap;`Flare;`Grounding`Totem;`Spirit`Link`Totem;`Nature's`Grasp;`Nature's`Swiftness;`Nature's`Swiftness;`Blind;`Bladestorm;`Mana`Tide`Totem;`Stealth;`Prowl;`Hand`of`Freedom;`Hand`of`Sacrifice;`Hand`of`Protection;`Master's`Call;`Roar`of`Sacrifice ^SEnabled^B ^SCLEUDur^N2 ^t^N5^T ^SSourceFlags^N4294967279 ^SEvents^T ^SOnShow^T ^Sg^F4874484302565712 ^f-54^SLocation ^SRaidWarningFrame^Sr ^N0^SSound ^STMW`-`Pling`6^SSoundData ^SInterface\\Addons\\TellMeWhen\\Sounds\\Pling6.ogg^t ^SOnStart^T ^Sg^N0.4 ^SLocation^SRaidWarningFrame ^Sr^N0 ^SText^S%u ^SChannel^SFRAME ^t^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SName^SPvP`Trinket ^SEnabled^B ^SCLEUDur^N2 ^t^t^SName^SSpell`Alert ^t^N48304^S`| ^Sgroup^N19 ^^</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"01 28 2012 14:57:20 (CST) (UTC-6:00)\" data-epoch=\"1327784240\">Jan 28, 2012</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/yeahno\">yeahno</a>","created_at":"2012-01-28T20:56:30Z"},{"body":" <p>Wrap it in 3 braces: <code>{{{^1^T ... ^^}}}</code></p>\r\n<p><code>^1^T^SPoint^T ^Sy^F-5134329198593323 ^f-45^Sx ^F7675418365828396^f-47 ^Spoint^STOPLEFT ^SrelativePoint^STOPLEFT ^t^SScale^N1 ^SEnabled^B ^SColumns^N5 ^SIcons^T ^N1^T ^SSourceFlags^N4294770671 ^SEvents^T ^SOnShow^T ^Sb^F7735594654071675 ^f-53^Sg ^N0^SLocation ^SRaidWarningFrame^t ^SOnStart^T ^Sg^N0 ^SLocation^SRaidWarningFrame ^Sr^F8689298104573663 ^f-54^SText ^S%u^SChannel ^SFRAME^t ^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SName^SDefensiveBuffs ^SEnabled^B ^SCLEUDur^N2 ^t^N2^T ^SSourceFlags^N4294770671 ^SEvents^T ^SOnShow^T ^Sb^N0 ^Sg^F8971876904722400 ^f-54^SLocation ^SRaidWarningFrame^t ^SOnStart^T ^Sb^F5651576002974740 ^f-58^Sg ^N0^SLocation ^SRaidWarningFrame^SText ^S%u^SChannel ^SFRAME^t ^t^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SType^Scleu ^SName^SDamageBuffs ^SFakeHidden^B ^SEnabled^B ^SCLEUDur^N2 ^t^N3^T ^SSourceFlags^N4294967279 ^SEvents^T ^SOnShow^T ^Sb^N0 ^SLocation^SRaidWarningFrame ^Sr^F8053495804239005 ^f-55^t ^SOnStart^T ^Sb^F8618653404536478 ^f-55^SLocation ^SRaidWarningFrame^Sr ^N0^SChannel ^SFRAME^t ^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_START^B ^t^SName^SHeals;~`PvPSpells ^SEnabled^B ^SCLEUDur^N2 ^t^N4^T ^SSourceFlags^N4294967279 ^SEvents^T ^SOnShow^T ^Sb^F7947528754183228 ^f-53^SLocation ^SRaidWarningFrame^Sr ^N0^SText ^S%u^SChannel ^SFRAME^SSound ^STMW~`-~`Ding~`5^SSoundData ^SInterface\\Addons\\TellMeWhen\\Sounds\\Ding5.ogg^t ^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SName^SSmoke~`Bomb;~`Psychic~`Scream;~`Death~`Coil;~`Scatter~`Shot;~`Vanish;~`Sap;~`Freezing~`Trap;~`Flare;~`Grounding~`Totem;~`Spirit~`Link~`Totem;~`Nature's~`Grasp;~`Nature's~`Swiftness;~`Nature's~`Swiftness;~`Blind;~`Bladestorm;~`Mana~`Tide~`Totem;~`Stealth;~`Prowl;~`Hand~`of~`Freedom;~`Hand~`of~`Sacrifice;~`Hand~`of~`Protection;~`Master's~`Call;~`Roar~`of~`Sacrifice ^SEnabled^B ^SCLEUDur^N2 ^t^N5^T ^SSourceFlags^N4294967279 ^SEvents^T ^SOnShow^T ^Sg^F4874484302565712 ^f-54^SLocation ^SRaidWarningFrame^Sr ^N0^SSound ^STMW~`-~`Pling~`6^SSoundData ^SInterface\\Addons\\TellMeWhen\\Sounds\\Pling6.ogg^t ^SOnStart^T ^Sg^N0.4 ^SLocation^SRaidWarningFrame ^Sr^N0 ^SText^S%u ^SChannel^SFRAME ^t^t^SFakeHidden^B ^SType^Scleu ^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SName^SPvP~`Trinket ^SEnabled^B ^SCLEUDur^N2 ^t^t^SName^SSpell~`Alert ^t^N48304^S~`~| ^Sgroup^N19 ^^</code></p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"01 28 2012 15:33:53 (CST) (UTC-6:00)\" data-epoch=\"1327786433\">Jan 28, 2012</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-28T21:33:41Z"},{"body":" <p>Reproduced the issue. Looks to be a bug in blizzard's code with the colors not getting managed correctly, but I should be able to implement a workaround.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-29T03:03:53Z"},{"body":" <p>Should work in most cases (should always work in arenas), but its still nothing more than a really, really good guess.</p>\r\n<p>Let me know if it works ok for you.</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"01 29 2012 02:32:15 (CST) (UTC-6:00)\" data-epoch=\"1327825935\">Jan 29, 2012</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-29T08:29:04Z"},{"body":" <p><cite>@<a href=\"https://github.com/tmw-issue-import/TellMeWhen/issues?q=%5BCF%20429%5D+in%3Atitle\" rel=\"nofollow\">Cybeloras</a>: <a href=\"https://github.com/tmw-issue-import/TellMeWhen/issues?q=%5BCF%20429%5D+in%3Atitle\" rel=\"nofollow\">Go</a></cite></p>\r\n<p>did some testing in bgs, and it seems to work perfectly. that goes for class cloring as well as the blizzard rw frame color taint. thanks a lot!</p>\r\n<p>in fact there's a small glitch, don't really know what might cause it. i unselsected exclude friendly target to do some testing with my rogue abilities and the color override kicks in perfectly - i hit evasion, it ignores the set color for defensive ability text and colors the text in rogue raidclasscolor. but any non friendly aura gains don't show the correct class color (didn't test in arena though). my guess is, that it doesn't have a lib or gathered data for units without any raidX/target/focus/arenaX to guess the corresponding class.</p>\r\n<p>i think i can override this behaviour by creating class specific spellists for selfbuffs as they only can be present on the given class, so that's only a minor issue. i'll post a more or less finished spell alerter setup for examples section soon.</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"01 29 2012 12:04:13 (CST) (UTC-6:00)\" data-epoch=\"1327860253\">Jan 29, 2012</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/yeahno\">yeahno</a>","created_at":"2012-01-29T10:38:55Z"},{"body":" <p>Yeah - The only way I am able to get the class from Combat Log Event icons is by scanning through a whole bunch of unitIDs. Here is the snippet of code that adds them to a list - you should be able to figure out what ones are checked to find a matching name:</p>\r\n<p>(Well, actually, when I went to post this just now I realized that somehow I didn't fix a major issue that basically makes all of the \"target\" and \"targettarget\" units pointless because they are not syntactically correct... I fixed it somewhere else, but forgot to past it into the main code. Here is the correct list of units that will be checked in the next revision:</p>\r\n<div><div><div>\n\n```\n\taddids(\"target\")\r\n\taddids(\"targettarget\")\r\n\taddids(\"targettargettarget\")\r\n\r\n\taddids(\"pet\")\r\n\taddids(\"pettarget\")\r\n\taddids(\"pettargettarget\")\r\n\r\n\taddids(\"focus\")\r\n\taddids(\"focustarget\")\r\n\taddids(\"focustargettarget\")\r\n\r\n\taddids(\"arena\",1,5)\r\n\taddids(\"boss\",1,5)\r\n\taddids(\"party\",1,4)\r\n\taddids(\"party\",1,4,\"pet\")\r\n\taddids(\"raid\",1,40)\r\n\r\n\taddids(\"arena\",1,5,\"target\")\r\n\taddids(\"boss\",1,5,\"target\")\r\n\taddids(\"party\",1,4,\"target\")\r\n\taddids(\"party\",1,4,\"pettarget\")\r\n\taddids(\"raid\",1,40,\"target\")\r\n\r\n\taddids(\"arena\",1,5,\"targettarget\")\r\n\taddids(\"boss\",1,5,\"targettarget\")\r\n\taddids(\"party\",1,4,\"targettarget\")\r\n\taddids(\"party\",1,4,\"pettargettarget\")\r\n\taddids(\"raid\",1,40,\"targettarget\")\r\n\n```\n</div></div>\r\n</div> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-29T18:44:53Z"},{"body":" <p>Just discovered a bug that is making it completely nonfunctional in detecting the class of a player from another server.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-29T18:58:10Z"},{"body":" <p>Colors should now always be obtained in battlegrounds.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-29T20:25:05Z"},{"body":" <p>Just one more thing that I noticed: You are using the \"Start\" event to handle the text, but if you use the \"Combat Event\" event instead then the icon will process all events - not just those that occur 2 seconds after the last event.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-01-29T22:07:17Z"},{"body":" <p>this is pure win, 5 stars for adding source and dest unit in the last event handled for textstring</p>\r\n<p>and yeah you're right i misinterpreted or let's say failed to read the tooltip of combat event as show conditional for text.</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"01 30 2012 06:15:10 (CST) (UTC-6:00)\" data-epoch=\"1327925710\">Jan 30, 2012</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/yeahno\">yeahno</a>","created_at":"2012-01-30T12:13:59Z"},{"body":" <p>since r434 there seems to be a problem with associating combat log events to the right player, e.g. rogues bladestorming using the spell alerter string i posted on the forums.\r\nin r432 it worked perfectly, don't know about r433, as i wasn't able to log in when it was released.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/yeahno\">yeahno</a>","created_at":"2012-02-03T20:05:14Z"},{"body":" <p>Try 435. I broke something that the unit substitutions depended upon</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-02-03T23:01:24Z"},{"body":" <p>Well, I figured out the real cause of this bug. Real fix is in r436</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"02 3 2012 17:11:19 (CST) (UTC-6:00)\" data-epoch=\"1328310679\">Feb 3, 2012</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2012-02-03T23:11:11Z"}]}