{"issue":{"title":"[CF 1266] Text notification set t o Raid warning (fake) not repsoecting font color - sets to black ","body":" <p>What steps will reproduce the problem?\r\n1. Set text notification to raid warning (fake)\r\n2. font oclor is ignored for typed in text (it will read black). Spell name reads fine</p>\r\n<p>What do you expect to happen? What happens instead?\r\nRespect font string color and not be black</p>\r\n<p>What version of TellMeWhen are you using? (\"The latest\" is not a version)\r\n8.1.2-2-g0a19738</p>\r\n<p>Do you have an error log of what happened?\r\nno but have image</p>\r\n<p>Please provide any additional information below (including any export strings if applicable; see above.)</p>\r\n<p>Setting a text notification set to raid warning (fake) would have the non dogtag text be black?</p>\r\n<p>I have [Spell] on cooldown for [MaxDuration] for the spell mend pet and it reads out everything in black but the spell name</p>\r\n<p>Anything else (picking errors frame, MSBT, Floating combat text) all respect the font color but fake raid warning looks like this:</p>\r\n<p><img src=\"http://i.imgur.com/glgC82u.jpg\" alt=\"\"></p> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/transitbus\">transitbus</a> | Imported from CurseForge issue <a href=\"https://wow.curseforge.com/projects/tellmewhen/issues/1266\">#1266</a> | <a href=\"https://github.com/tmw-issue-import/dump/blob/master/html/1266.html\">Raw</a>","closed":true,"closed_at":"2016-08-15T00:40:15Z","created_at":"2016-08-07T05:04:35Z","updated_at":"2016-08-15T03:48:01Z","labels":["defect","resolved"]},"comments":[{"body":" <p>Looks like you no longer need \"bullshitTable\" for arguement 3 in Components\\EventHandlers\\Announcements\\Announcements.lua and RaidNotice_AddMessage</p>\r\n<p>Around line 447 is the code block</p>\r\n<p>You can add in the smae color output you have for other text settings and then reword the 3rd argument into a variable like so</p>\r\n<p>remark out or remove </p>\r\n<p>Text = \"|c\" .. eventSettings.TextColor .. Text .. \"|r\"</p>\r\n<p>and add/change </p>\r\n<p>\tlocal color = TMW:StringToCachedRGBATable(eventSettings.TextColor)</p>\r\n<p>\tRaidNotice_AddMessage(RaidWarningFrame, Text, color, eventSettings.TextDuration)</p>\r\n<p>Should then allow your to remove </p>\r\n<p>local bullshitTable = {} at line 426</p>\r\n<p>So then the whole section looks like this</p>\r\n<div><div><div>\n\n```\nAnnouncements:RegisterEventHandlerDataNonSpecific(71, \"RAID_WARNING_FAKE\", {\r\n\ttext = L[\"RAID_WARNING_FAKE\"],\r\n\tdesc = L[\"RAID_WARNING_FAKE_DESC\"],\r\n\r\n\tConfigFrames = {\r\n\t\t\"ShowIconTex\",\r\n\t\t\"Color\",\r\n\t\t\"TextDuration\",\r\n\t},\r\n\r\n\thandler = function(icon, eventSettings, Text)\r\n\t\tlocal Location = eventSettings.Location\r\n\r\n\t\tif eventSettings.ShowIconTex then\r\n\t\t\tText = \"|T\" .. (icon.attributes.texture or \"\") .. \":0|t \" .. Text\r\n\t\tend\r\n\r\n\t\t-- GLOBALS: RaidWarningFrame, RaidNotice_AddMessage\r\n\t\t\r\n\t\tlocal color = TMW:StringToCachedRGBATable(eventSettings.TextColor)\r\n\r\n\t\tRaidNotice_AddMessage(RaidWarningFrame, Text, color, eventSettings.TextDuration)\r\n\t\t\r\n\tend,\r\n})\r\n\n```\n</div></div>\r\n</div> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"08 7 2016 16:11:09 (CDT) (UTC-5:00)\" data-epoch=\"1470604269\">Aug 7, 2016</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/transitbus\">transitbus</a>","created_at":"2016-08-07T05:26:14Z"},{"body":" <p>Unfortunately, Blizzard's code still manages colors incorrectly, so the solution has to be a bit different than what you provided.</p>\r\n<p>To see the issue with your code, make two handlers - one with blue text, and the other with red. Then, test them in an alternating sequence. If there are already two messages in the frame, then when you display the red message, the previous blue message will turn red.</p>\r\n<p>Changing the old color injection line to the following fixes the issue with colors after the link:</p>\r\n<p><code>Text = \"|c\" .. eventSettings.TextColor .. Text:gsub(\"|r\", \"|c\" .. eventSettings.TextColor) .. \"|r\"</code></p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2016-08-15T00:35:16Z"},{"body":" <p>LOL don't even mind how it's fixed so long as it's fixed <span>;)</span></p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/transitbus\">transitbus</a>","created_at":"2016-08-15T03:48:01Z"}]}