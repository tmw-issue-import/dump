{"issue":{"title":"[CF 799] Boss ability tracker ","body":" <p>Alright, next idea.</p><p>We've been sophisticating our raid tactics and specifying cooldowns like so:</p><p>[1] Interrupting Jolt&nbsp; &nbsp; Ghinz Rally&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0:00:00<br>[2] Interrupting Jolt&nbsp; &nbsp; Crymlink devo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0:00:18<br>[3] Interrupting Jolt&nbsp; &nbsp; Jéddy devo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0:00:36<br>[4] Interrupting Jolt&nbsp; &nbsp; Jav&nbsp; &nbsp; devo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0:00:54<br>[5] Interrupting Jolt&nbsp; &nbsp; Qel Rally&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0:01:12<br>[6] Interrupting Jolt&nbsp; &nbsp; Hayek Rally&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0:01:30<br>[7] Interrupting Jolt&nbsp; &nbsp; Ghinz Banner&nbsp; &nbsp; &nbsp; &nbsp; Scripè&nbsp; &nbsp; &nbsp; &nbsp; 0:01:48<br>[8] Interrupting Jolt&nbsp; &nbsp; Qel Banner&nbsp; &nbsp; &nbsp; &nbsp; Lorane&nbsp; &nbsp; &nbsp; &nbsp; 0:02:06<br>[9] Interrupting Jolt&nbsp; &nbsp; Hayek Banner&nbsp; &nbsp; &nbsp; &nbsp; Toscar&nbsp; &nbsp; &nbsp; &nbsp; 0:02:24<br>[10] Interrupting Jolt&nbsp; &nbsp; Valkiery Spirit Shell&nbsp; &nbsp; Syysigkeiten&nbsp; &nbsp; 0:02:42<br>[11] Interrupting Jolt&nbsp; &nbsp; Scylla Spirit Shell&nbsp; &nbsp; Laeryth&nbsp; &nbsp; &nbsp; &nbsp; 0:03:00</p><p>Do you think it would be possible to make an icon that would reliably inform me when it was my turn to pop a certain cd?</p> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a> | Imported from CurseForge issue <a href=\"https://wow.curseforge.com/projects/tellmewhen/issues/799\">#799</a> | <a href=\"https://github.com/tmw-issue-import/dump/blob/master/html/799.html\">Raw</a>","closed":true,"closed_at":"2013-05-03T16:41:50Z","created_at":"2013-04-25T15:26:56Z","updated_at":"2013-05-03T16:41:50Z","labels":["enhancement","resolved"]},"comments":[{"body":" <p>You could use a Combat Event icon to notify you when the person before you has used their ability. Set the timer so that it will be the duration between when they use their ability and when you use your ability, and then add some On Finish event handler to scream and yell at you to use your ability.</p>\r\n<p>I'm not familiar with what Interrupting Jolt is since I don't raid anymore, but if it fits with what the ability is (I'm guessing its a cast that causes a ton of raid damage?), you could also set the timer to be slightly longer than the window in which you need to use your ability, add a condition to watch for Interrupting Jolt, and then add an On Show event handler to scream and yell at you. Since the icon will only be shown while counting and while the condition passes, it will only show right after the last person used their ability when IJ is happening, but the timer will expire before it is time for the next person to use theirs after you use yours.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-25T16:48:21Z"},{"body":" <p>The problem with the first suggestion is that I don't want to rely on other people in my raid to always remember their cooldowns.</p>\r\n<p>The problem with the second suggestion is that some boss timers are not quite that predictable and might work with a cooldown and then have a certain window in which they're cast. They also might interact with other boss abilities, altering the timers further.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a>","created_at":"2013-04-27T17:35:42Z"},{"body":" <p>What do you propose for a new icon type, then? How does it function and what configuration options are available?</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-28T00:22:54Z"},{"body":" <p>Ideally it'd be some kind of counter that counts how often a boss has used a certain ability and resets when the encounter resets. It wouldn't have to be a new icon type, just a condition that can be set to something like (\"Interrupting Jolt\" = 6) or (\"Interrupting Jolt\" = 9).</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a>","created_at":"2013-04-28T02:31:28Z"},{"body":" <p>Added in r794. Spell Cast Count in the Spells/Items category.</p>\r\n<p>If you want to use it in a Lua condition, use</p>\r\n<div><div><div>\n\n```\nUnitCastCount(\"unit\", \"spell name\")\r\n\n```\n</div></div>\r\n</div><p>or</p>\r\n<div><div><div>\n\n```\nUnitCastCount(\"unit\", spellID)\r\n\n```\n</div></div>\r\n</div> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-28T03:29:15Z"},{"body":" <p><cite>@<a href=\"https://github.com/tmw-issue-import/TellMeWhen/issues?q=%5BCF%20799%5D+in%3Atitle\" rel=\"nofollow\">Cybeloras</a>: <a href=\"https://github.com/tmw-issue-import/TellMeWhen/issues?q=%5BCF%20799%5D+in%3Atitle\" rel=\"nofollow\">Go</a></cite></p>\r\n<p>How could this condition reset? The checked unit is dead? or other? Is it possible to make a option to set a cap to reset that condition?</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"04 28 2013 03:02:23 (CST) (UTC-5:00)\" data-epoch=\"1367136143\">Apr 28, 2013</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/lsjyzjl\">lsjyzjl</a>","created_at":"2013-04-28T07:53:52Z"},{"body":" <p>Tracks things per GUID. Players will never be reset. Pets will be reset when summoned (since they get a different GUID every time). Bosses will get a different GUID every time they are spawned (well, I sure as hell hope they would. Would be weird if they didn't), so a boss will reset for each attempt. Normal NPCs will be reset when they die and a new one spawns in its place.</p>\r\n<p>If a unit dies close enough to the player to be seen in the combat log, its data will be immediately forgotten (although the condition may not be immediately updated to reflect that). Unit Cooldowns now behave the same way too (as of the last revision as of the time of writing this comment) - non players that die will have their cooldown data wiped to prevent excessive memory usage.</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"04 28 2013 03:03:10 (CST) (UTC-5:00)\" data-epoch=\"1367136190\">Apr 28, 2013</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-28T08:02:25Z"},{"body":" <p>If you want some functionality like having the condition pass every N casts, do something like this in a Lua condition:</p>\r\n<div><div><div>\n\n```\n(UnitCastCount(\"unit\", \"spell name\") - N) % M == 0\r\n\n```\n</div></div>\r\n</div><p>where N is the first cast that the condition should pass for and M is the number of casts after that at which it should be shown.</p>\r\n<p>For example, if N = 2 and M = 3, then the condition would pass on the 2nd, 5th, 8th, 11th, etc. casts. If N = 0 and M = 2, the the condition would pass on every even numbered cast (including 0).</p>\r\n<p>Going to sleep now, I can help more tomorrow.</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"04 28 2013 03:12:58 (CST) (UTC-5:00)\" data-epoch=\"1367136778\">Apr 28, 2013</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-28T08:11:57Z"},{"body":" <p>Is the counter going to go up when the unit starts casting or finishes? Either can probably work, in my case it'd just usually be simpler if the counter jumped at the beginning of a cast. Then again, somebody else might only be interested in successful casts.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a>","created_at":"2013-04-28T13:38:28Z"},{"body":" <p>It starts when the cast finishes. The combat log is very restrictive about notifying of when casts start (it doesn't notify at all, actually - you can only check this using the UNIT_SPELLCAST_START event, which only works for units that have a valid unitID), so it has to work when the cast finishes. Channeled casts are counted as soon as they begin.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-28T17:28:40Z"},{"body":" <p>I didn't follow the conversation from the start but I'm pretty sure bosses don't get a new GUID when they spawn.</p>\r\n<p>If that was the case things like LibBossIDs-1.0 would never work or wowhead having static NPCID.</p>\r\n<p>If I misunderstood what you were discussing, apologies :P</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Road_Block\">Road_Block</a>","created_at":"2013-04-29T00:53:46Z"},{"body":" <p>A unit's GUID isn't the same as its npcID. npcID is actually one part of the GUID, but there is a lot more to it. My GUID, for example, is 0x0580000008311F15, and it will stay the same until I were to pay to transfer off the server I play on (although the first bit of it may change as I hop across realms and instances and battlegrounds - I'm not sure if that is true anymore since everybody is always in the cross-realm system now as opposed to only being it it for battlegrounds, but it used to be the case a long time ago).</p>\r\n<p>The GUID of the spawn of Cloudrunner Leng, the flying trainer in the alliance city in Pandaria, that is on Aerie Peak right now, is 0xF130EB0600000C92. 0xEB06 is the part of that that is his npcID (60166 in base 10). 0x000C92 is his spawn counter. If he were to be somehow killed, the one that replaces him would have a different spawn counter.</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"04 28 2013 20:40:51 (CST) (UTC-5:00)\" data-epoch=\"1367199651\">Apr 28, 2013</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-29T01:40:06Z"},{"body":" <p>Alright, I've done a few bosses now with the new condition and I am able to achieve the functionality that I'm looking for, I just feel like it could be done a little simpler. Since I only want to be alerted when say Interrupting Jolt #6 is incoming in 3 seconds I need some kind of timer to count the seconds since the last Interrupting Jolt was cast. And the only way I can do that is via a combat event icon. So I need to make a new combat event icon for every spell. Example:</p>\r\n<p>^1^T^SType^Scleu ^SConditions^T ^N1^T ^SType^SCASTCOUNT ^SUnit^Sboss1 ^SName^SInterrupting`Jolt ^SLevel^N6 ^t^Sn^N1 ^t^SSourceUnit^Sboss1 ^SName^SInterrupting`Jolt ^SFakeHidden^B ^SShowWhen^N1 ^SCustomTex^SDemoralizing`Banner ^SCLEUEvents^T ^SSPELL_CAST_SUCCESS^B ^t^SCLEUDur^N15 ^SEnabled^B ^t^N62045^S`| ^Sicon^^</p>\r\n<p>Also I haven't been able to figure out what I should do if I was supposed to take the first ability. This happened with Cosmic Barrage on Twin Consorts. Since there is no preceding Cosmic Barrage to start the timer I would have to start a timer when the boss is pulled, which doesn't seem to be possible. I've been thinking for a while on possible solutions. The one that would require the least changes to the addon would probably just to make 'raidboss engaged' a detectable event for combat event icons. The (for me) more userfriendly solution would be to add another box to the spell cast count condition \"time since last cast\", where if there is no last cast it uses the time since the boss was engaged instead. Then again this could be its own condition. Then again I could just use a combat event icon. Then again most conditions would be redundant following that logic.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a>","created_at":"2013-04-30T01:17:27Z"},{"body":" <p>I think we are starting to reach the point that these features are just becoming far too specific for what TMW was originally intended for - a simple-yet-versatile combat tracking addon. Some things do make sense being added as some generalized function, like the Cast Count condition, since they could be used for a ton of different purposes.</p>\r\n<p>Adding another input to the condition just isn't possible without a huge redesign of the condition editor. The best way to implement this whole thing would be as a new icon type, but it isn't something that I am going to develop at this point - my WoW sub runs out in less than two weeks, and after that, that's it as far as new features in TMW developed by me go.</p>\r\n<p>I may hop on the beta for the next expansion once us addon authors get our free keys and add in whatever needs to be added for basic functionality with whatever API changes and game system changes are made - but that is still at least 6 months away, possibly even up to a year.</p>\r\n<p>I don't mean anything malicious by this, but there does exist a point where addon functionality should end and playing the game with a high level of situational awareness &amp; communication should begin. If you or somebody else wants to develop new things like this for TMW (<a href=\"http://wow.curseforge.com/addons/tellmewhen/pages/api/\" rel=\"nofollow\">http://wow.curseforge.com/addons/tellmewhen/pages/api/</a>) then feel free to do so, but I personally can't see anything more along these lines of a raid cooldown usage helper fitting into TMW. Sorry.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-30T01:53:14Z"},{"body":" <p>Not even the 'raidboss engaged' as a combat event? <span>:(</span></p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a>","created_at":"2013-04-30T02:31:36Z"},{"body":" <p>You could do that using a condition icon - either check Unit Exists (\"boss1\") or check <code>IsEncounterInProgress()</code> in a Lua condition.</p>\r\n<p>I've never actually used IsEncounterInProgress and wasn't aware that it existed until about 2 minutes ago, so I'm not sure how good it will be or what exactly determine if an encounter is in progress. Its only use in FrameXML is to disable the \"Release Spirit\" button while in a boss fight, so it should be OK. I don't know what events it might respond to, so it will not be very efficient just as a Lua condition or as a normal condition with no events (but you would have to have tens or of thousands of calls per second before you would notice a difference in framerate).</p> <div class=\"project-issue-comment-body-modified\"> <hr> <span class=\"e-infoLabel\">Edited</span><span> <abbr class=\"tip standard-date standard-datetime\" title=\"04 29 2013 21:47:12 (CST) (UTC-5:00)\" data-epoch=\"1367290032\">Apr 29, 2013</abbr></span> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-30T02:40:08Z"},{"body":" <p>The thing is I want to start a timer as soon as I enter combat so I can alert myself after x seconds that an ability is incoming.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a>","created_at":"2013-04-30T02:45:00Z"},{"body":" <p>IsEncounterInProgress() should do just that - I believe that it will start returning true the moment that you engage a boss.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-30T02:48:20Z"},{"body":" <p>I'm not sure how this would work. Suppose I want to show an icon 45 seconds after we've pulled a boss. How would I use IsEncounterInProgress()?</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/AmeroGer\">AmeroGer</a>","created_at":"2013-04-30T02:53:32Z"},{"body":" <p>Uhhh... Uh.......</p>\r\n<p>Shit. Condition icons need a \"Only show if timer is not active\" option, don't they? Otherwise, there really isn't a way. I ran into this same problem helping someone else a few hours ago - I was trying to pull some wizard magic using condition icon timers and it just didn't work very well at all - the end solution I came up with was quite horrifying.</p>\r\n<p>I'll get back to you when I've added this in. Brb, churning code.</p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-30T03:00:37Z"},{"body":" <p>For r800</p>\r\n<p><code>^1^T^SType^Sconditionicon ^SOnlyIfNotCounting^B ^SConditionDurEnabled^B ^SConditionDur^N45 ^SCustomTex^S1 ^SConditions^T ^N1^T ^SType^SLUA ^SName^SIsEncounterInProgress() ^t^Sn^N1 ^t^SEnabled^B ^t^N62047^S~`~| ^Sicon^^</code></p> <div class=\"project-issue-comment-body-modified\"> </div> \n<br>\n\n> Posted by CurseForge user <a href=\"https://wow.curseforge.com/members/Cybeloras\">Cybeloras</a>","created_at":"2013-04-30T03:31:49Z"}]}